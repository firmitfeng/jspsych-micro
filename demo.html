<!DOCTYPE html>
<html lang="zh-cn">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="css/global.css">
    <title>DEMO- Experiment</title>
</head>

<body>
    <div class="exp-wrap">
        <div id="exp"></div>
    </div>
    <div id="mask" class="hidden"></div>
    <script src="js/utils.js"></script>
    <script src="js/jspsy-micro.js"></script>

    <script type="text/javascript">

        (async function () {
            var s, kb, result;
            jspsych.init();
            jspsych.fillText({ x: 100, y: 100 });
            await jspsych.flip();
            s = await jspsych.waitMiSec(1000);
            console.log(performance.now() - s);
            await jspsych.render();
            await jspsych.waitMiSec(1000);
            jspsych.cleanScreen();
            // jspsych.render();
            jspsych.fillImg({ url: 'imgs/cross.jpg', x: 300, y: 200, w: 50, h: 50 });
            jspsych.putObjToCenter(jspsych.lastDOM);
            await jspsych.flip();
            await jspsych.render();
            await jspsych.waitMiSec(1000);
            jspsych.fillCircle();
            jspsych.putObjToCenter(jspsych.lastDOM);
            // let circle = jspsych.fillCircle();
            // jspsych.putObjToCenter(circle);
            jspsych.fillRectangle({ x: 200, y: 200 });
            jspsych.fillRectangle({ x: 200, y: 525 });
            kb = await jspsych.waitKB();
            console.log(kb);
            s, result = await jspsych.waitKBSecs(2000);
            console.log(result, isNaN(result));
            await jspsych.flip();
            await jspsych.render();
            s = await jspsych.waitMiSec(1000);
            console.log(performance.now() - s, s);
            ///////////////////////////////////////////////////////            
            jspsych.fillText({ content: 'this is secend line', x: 100, y: 100 });
            await jspsych.flip();
            await jspsych.render();
            logger.log = ('render 2nd line');
            s = await jspsych.waitMiSec(1000);
            console.log(performance.now() - s, s);
            await jspsych.flip();
            await jspsych.render();
            logger.log = ('render blank screen');
            await jspsych.waitMiSec(1000);
            jspsych.fillText({ content: 'this is 3rd line', x: 100, y: 100 });
            await jspsych.flip();
            await jspsych.render();
            logger.log = ('render 3rd line');
            await jspsych.waitMiSec(1000);
            jspsych.cleanScreen();
            let cross = jspsych.fillImg({ url: 'imgs/cross.jpg', x: 300, y: 200 });
            jspsych.putObjToCenter(cross);
            await jspsych.waitMiSec(1000);
            await jspsych.flip();
            await jspsych.render();
            await jspsych.waitMiSec(1000);
            let r_cross = jspsych.fillImg({ url: 'imgs/cross.jpg', x: 300, y: 200 });
            await jspsych.flip();
            for (let i = 0; i < 90; i++) {
                jspsych.rotateObj(r_cross, i + 1);

                await jspsych.render();
                // await jspsych.waitMiSec(50);
            }
        })();
        // window.requestAnimationFrame(jspsych.render);
    </script>
</body>

</html>