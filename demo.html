<!DOCTYPE html>
<html lang="zh-cn">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="css/global.css">
    <title>DEMO- Experiment</title>
</head>

<body>
    <div class="exp-wrap">
        <div id="exp"></div>
    </div>
    <div id="mask" class="hidden"></div>
    <script src="js/utils.js"></script>
    <script src="js/jspsy-micro.js"></script>

    <script type="text/javascript">
        let _default = {
            bgColor: 'rgb(200,200,200)',
            elemID: 'exp',
            elemStyle: {
                width: '800px',
                height: '600px',
                border: '1px solid #000',
            },
            debug: true,
        };
        (async function () {
            var s, kb, result;
            jspsycho.init();
            jspsycho.fillText({ x: 100, y: 100 });
            await jspsycho.flip();
            s = await jspsycho.waitMiSec(1000);
            console.log(performance.now() - s);
            await jspsycho.render();
            await jspsycho.waitMiSec(1000);
            jspsycho.cleanScreen();
            // jspsycho.render();
            jspsycho.fillImg({ url: 'imgs/cross.jpg', x: 300, y: 200, w: 50, h: 50 });
            jspsycho.putObjToCenter(jspsycho.lastDOM);
            await jspsycho.flip();
            await jspsycho.render();
            await jspsycho.waitMiSec(1000);
            jspsycho.fillCircle();
            jspsycho.putObjToCenter(jspsycho.lastDOM);
            // let circle = jspsycho.fillCircle();
            // jspsycho.putObjToCenter(circle);
            jspsycho.fillRectangle({ x: 200, y: 200 });
            jspsycho.fillRectangle({ x: 200, y: 525 });
            kb = await jspsycho.waitKB();
            console.log(kb);
            s, result = await jspsycho.waitKBSecs(2000);
            console.log(result, isNaN(result));
            await jspsycho.flip();
            await jspsycho.render();
            s = await jspsycho.waitMiSec(1000);
            console.log(performance.now() - s, s);
            ///////////////////////////////////////////////////////            
            jspsycho.fillText({ content: 'this is secend line', x: 100, y: 100 });
            await jspsycho.flip();
            await jspsycho.render();
            logger.log = ('render 2nd line');
            s = await jspsycho.waitMiSec(1000);
            console.log(performance.now() - s, s);
            await jspsycho.flip();
            await jspsycho.render();
            logger.log = ('render blank screen');
            await jspsycho.waitMiSec(1000);
            jspsycho.fillText({ content: 'this is 3rd line', x: 100, y: 100 });
            await jspsycho.flip();
            await jspsycho.render();
            logger.log = ('render 3rd line');
            await jspsycho.waitMiSec(1000);
            jspsycho.cleanScreen();
            let cross = jspsycho.fillImg({ url: 'imgs/cross.jpg', x: 300, y: 200 });
            jspsycho.putObjToCenter(cross);
            await jspsycho.waitMiSec(1000);
            await jspsycho.flip();
            await jspsycho.render();
            await jspsycho.waitMiSec(1000);
            let r_cross = jspsycho.fillImg({ url: 'imgs/cross.jpg', x: 300, y: 200 });
            await jspsycho.flip();
            for (let i = 0; i < 90; i++) {
                jspsycho.rotateObj(r_cross, i + 1);

                await jspsycho.render();
                // await jspsycho.waitMiSec(50);
            }
        })();
        // window.requestAnimationFrame(jspsycho.render);
    </script>
</body>

</html>